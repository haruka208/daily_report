## ・取り組んだ課題一覧
- 現場で使えるDjangoの教科書

## ・わかったこと

### モデル（Model）
- 発行されるクエリを確認する
  - `print(クエリセット.query)` そのクエリセットが実際にどんなSQLになるかを確認できる
  - ロギングの設定を変更　設定を変更して発行されるクエリをコンソールやログにリアルタイムで出力できる
  - `django-debug-toolbar`のSQLパネルを使用 GUIでのデバック環境
- `selecte_related` `prefetch_related`を使ってクエリ本数を減らす
  - `selecte_related`
    - リレーション先のオブジェクトを発行するためにJOINを使ったクエリを発行できる
    - 「一」や「多」側から「一」側のオブジェクトをJOINで取得できる
  - `prefetch_related` 
    - 取得したオブジェクト群をオブジェクト内部のキャッシュに保持して使い回す
    - 「一」や「多」側から「多」側のリレーションのモデルを参照する場合に使用

### テンプレート（Template）
- `{# #}` テンプレート内のコメント
#### 変数表示
- テンプレートに渡された「コンテキスト（変数と値がマッピングされたオブジェクト」に格納されている変数を参照できる
  - ビューからコンテキストとして渡された変数（`TemplateResponse`のイニシャライザ、`rendar()`の引数として渡されるもの）
  - `settings.py`の`TEMPLATES` -> `'OPTIONS'` -> `'context_processors'`に設定すればビューから渡さなくても使用できる
- デフォルトで利用できる引数
  - `request` 現在のリクエストオブジェクト
  - `user` ログイン中のユーザーオブジェクト
  - `perms` ログイン中のユーザーのパーミッション情報
  - `messages` フラッシュメッセージ（ログイン成功時の「ようこそ」など）
- 変数の中身に`.`を使ってアクセスする挙動`{{ user.username }}`
  - この書き方で辞書・オブジェクト・関数・リストのどれにも対応できるように設計されている
  - 1. 辞書としての照合 : `user`が辞書型だった場合、キー`'username'` を指定して取り出す
  - 2. 属性値としての照合 : `user` がオブジェクトだった場合、`username` という 属性（プロパティ） を取り出す
  - 3. メソッド呼び出し : `username()` が メソッド（関数） の場合は、自動的に呼び出して結果を表示
  - 4. リストやタプルの添字指定 : `user` がリストやタプルのとき、`username` がインデックスだったらその要素を取り出す
- 変数表示する際はクロスサイトスクリプティング対策として`<` `>` `'` `"` `&` が自動エスケープされる
#### フィルタ
- `|`を使って記述。変数の表示内容を加工。引数はフィルタの直後に`:`で繋げて書く
- `{{ <変数名>|<フィルタ名>:<引数>|<フィルタ名2>:<引数> }}`
  - 代表的な変数
    - `default` 変数が存在しない場合、あるいは値がNone等の場合に指定した文字列を表示
    - `length` 文字列長やリストのサイズを表示
    - `safe` エスケープの無効化（変数の内容が安全な場合のみ使用）
    - `date` 日時や日付オブジェクトを指定した形式に変換表示
    - `linebreaksbr` 改行タグの変換（`\n` →`<br>`)
    - `urize` リンク変換
    - `truncatechars_html` 決められた文字数まで文字の切り詰め＋「...」表示
#### テンプレートタグ
  - `if` 条件分岐
  -  `for` 繰り返し
     -  `forloop.counter` ループ回数（１から開始）
     - `forloop.counter0` ループ回数（０から開始）
     - `forloop.first` 最初のループかどうか
  - `extends` テンプレートの継承、子テンプレートの冒頭に記述する（ `block`の内容を上書き）
  - `block` `{ % block <任意の名前> %}`と`{% endblock %}`で囲まれた範囲に任意の名前をつけて上書きができるようにする
    - `block.super` 継承元となる親テンプレートのブロック内部をそのまま保持した変数
  - `include` 外部テンプレートの読み込み
    - `_`読み込まれる側のテンプレート先頭に付ける
  - `static` 静的ファイルの配信用URL取得（`<link rel="stylesheet" href="/static/myapp/style.css">`のような）
    - 組み込みタグではないため読み込みが必要 `{% load static %}`
  - `url` URL逆引き。テンプレートにURLをハードコーディングしないようにできる
  - `autoescape` 自動エスケープ制御

### フォーム（Form）
- Djngoのフォームは、HTMLのfrom要素内の入力項目をフィールド(=クラス変数)として持つクラスのことを指す
- フォームの役割
  - ユーザーの入力データを保持する
  - 入力データのバリデーションを行う
  - テンプレートでHTMLのfrom要素の入力項目やエラーメッセージを出力


## ・感じたこと
- 限られた時間だが、朝早く起きたり、工夫することでもう少し学習時間は伸ばせた
- 貪欲に勉強時間を伸ばす


## ・次やること
- 現場で使えるDjangoの教科書

## ・学習時間
- today:  3.5h
- total  : 708.5h


